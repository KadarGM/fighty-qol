<form autocomplete="off" style="height: 100%; display: flex; flex-direction: column;">
    <div class="vfxor-editor-wrapper" style="display: flex; flex-grow: 1; overflow: hidden; height: 100%;">
        
        <div class="vfxor-sidebar" style="width: 220px; border-right: 1px solid #555; padding-right: 10px; display: flex; flex-direction: column;">
            <button type="button" id="vfxor-add-effect" style="margin-bottom: 10px; background: #2d5a2d;">
                <i class="fas fa-plus"></i> New Effect
            </button>
            <ul style="list-style: none; padding: 0; margin: 0; overflow-y: auto; flex-grow: 1;">
                {{#each effects as |effect id|}}
                <li style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                    <button type="button" class="vfxor-select-effect" data-id="{{id}}" style="flex-grow: 1; text-align: left; padding-left: 10px; background: {{#if (eq ../currentEffectId id)}}#555{{else}}#222{{/if}}; border-right: none;">
                        {{effect.name}}
                    </button>
                    <button type="button" class="vfxor-delete-effect" data-id="{{id}}" style="flex-grow: 0; width: 35px; background: #8b0000; border-left: none;">
                        <i class="fas fa-trash"></i>
                    </button>
                </li>
                {{/each}}
            </ul>
        </div>

        <div class="vfxor-workspace" style="flex-grow: 1; padding-left: 15px; overflow-y: auto; display: flex; flex-direction: column;">
            {{#if currentEffectId}}
            
            <div style="display: flex; justify-content: space-between; align-items: flex-end; margin-bottom: 10px;">
                <div class="form-group" style="flex-grow: 1; margin-right: 15px;">
                    <label style="font-size: 1.2em; font-weight: bold; margin-bottom: 5px; display: block;">Effect Name</label>
                    <input type="text" name="effects.{{currentEffectId}}.name" value="{{currentEffect.name}}" style="font-size: 1.1em; padding: 5px; width: 100%;">
                </div>
                <button type="button" class="vfxor-preview-effect" style="background: #a67c00; width: 150px; height: 35px; color: #fff;">
                    <i class="fas fa-play"></i> Play Preview
                </button>
            </div>

            <div id="vfxor-preview-screen" style="width: 100%; height: 250px; background: #000; border: 1px solid #444; border-radius: 5px; position: relative; overflow: hidden; margin-bottom: 15px; flex-shrink: 0; display: flex; justify-content: center; align-items: center; background-image: radial-gradient(circle, #222 10%, #000 80%);">
                <span style="position: absolute; bottom: 5px; right: 10px; color: #444; font-size: 0.8em; font-weight: bold;">PREVIEW WINDOW</span>
            </div>
            
            <hr style="border-color: #444; margin-bottom: 15px; flex-shrink: 0;">
            <h3 style="margin-top: 0; color: #aaa; flex-shrink: 0;">Visual Layers</h3>
            
            <div id="vfxor-layers-container" style="flex-grow: 1;">
                {{#each currentEffect.layers as |layer index|}}
                <div class="vfxor-layer" style="background: #1a1a1a; border: 1px solid #444; padding: 10px; margin-bottom: 10px; border-radius: 5px; position: relative;">
                    
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px; border-bottom: 1px solid #333; padding-bottom: 5px;">
                        <strong style="color: #4a90e2;"><i class="fas fa-layer-group"></i> Layer {{index}}</strong>
                        <button type="button" class="vfxor-delete-layer" data-index="{{index}}" style="width: 30px; height: 30px; padding: 0; background: #8b0000; line-height: 30px;">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    
                    <div class="form-group" style="margin-bottom: 10px;">
                        <label>Animation File (.webm / .webp)</label>
                        <div style="display: flex; gap: 5px;">
                            <input type="text" name="effects.{{../currentEffectId}}.layers.{{index}}.file" value="{{layer.file}}" style="flex-grow: 1;">
                            <button type="button" class="vfxor-file-picker" data-target="effects.{{../currentEffectId}}.layers.{{index}}.file" style="width: 40px; background: #444;">
                                <i class="fas fa-folder-open"></i>
                            </button>
                        </div>
                    </div>

                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                        <div class="form-group">
                            <label>Delay (ms)</label>
                            <input type="number" name="effects.{{../currentEffectId}}.layers.{{index}}.delay" value="{{layer.delay}}" step="100">
                        </div>
                        <div class="form-group">
                            <label>Scale (Size)</label>
                            <input type="number" name="effects.{{../currentEffectId}}.layers.{{index}}.scale" value="{{layer.scale}}" step="0.1" min="0.1">
                        </div>
                        <div class="form-group">
                            <label>Playback Speed</label>
                            <input type="number" name="effects.{{../currentEffectId}}.layers.{{index}}.speed" value="{{layer.speed}}" step="0.1" min="0.1">
                        </div>
                        <div class="form-group">
                            <label>Color Tint</label>
                            <div style="display: flex; gap: 5px;">
                                <input type="color" name="effects.{{../currentEffectId}}.layers.{{index}}.tint" value="{{layer.tint}}" style="width: 40px; padding: 0; cursor: pointer;">
                                <input type="text" value="{{layer.tint}}" disabled style="flex-grow: 1; background: #222;">
                            </div>
                        </div>
                    </div>
                </div>
                {{/each}}
            </div>
            
            <button type="button" id="vfxor-add-layer" style="margin-top: 10px; background: #333; border: 1px dashed #777; flex-shrink: 0;">
                <i class="fas fa-plus"></i> Add New Layer
            </button>
            
            {{else}}
            <div style="text-align: center; color: #777; margin-top: 100px; display: flex; flex-direction: column; align-items: center;">
                <i class="fas fa-photo-video" style="font-size: 3em; margin-bottom: 15px; opacity: 0.5;"></i>
                <p>Select an effect from the list or create a new one to start compositing.</p>
            </div>
            {{/if}}
        </div>
    </div>
    
    <div style="padding-top: 15px; border-top: 1px solid #555; margin-top: 15px; flex-shrink: 0;">
        <button type="submit" style="width: 100%; font-size: 1.1em; padding: 8px; background: #004080;">
            <i class="fas fa-save"></i> Save Effects
        </button>
    </div>
</form>